<div class="modal-content bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col">
  <!-- Header -->
  <div class="px-6 py-4 border-b border-gray-200">
    <div class="flex items-center justify-between">
      <h2 class="text-2xl font-bold text-gray-800">Sets auswählen</h2>
      <button
        (click)="close()"
        class="text-gray-400 hover:text-gray-600 text-2xl font-bold leading-none"
        aria-label="Schließen"
      >
        ×
      </button>
    </div>
  </div>

  <!-- Filter-Bereich -->
  <div class="px-6 py-4 border-b border-gray-200 space-y-4">
    <!-- Erste Zeile: Suche und Set-Typ -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <!-- Suchfeld -->
      <div>
        <label for="search" class="block text-sm font-medium text-gray-700 mb-2">
          Suche (Name, Code, Datum)
        </label>
        <input
          id="search"
          type="text"
          [(ngModel)]="searchQuery"
          placeholder="z.B. Modern, MH3, 2024-06..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        />
      </div>

      <!-- Set-Typ Filter -->
      <div>
        <label for="setType" class="block text-sm font-medium text-gray-700 mb-2">
          Set-Typx
        </label>
        <select
          id="setType"
          [(ngModel)]="selectedSetType"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        >
          @for (type of availableSetTypes(); track type.value) {
            <option [value]="type.value">{{ type.label }}</option>
          }
        </select>
      </div>
    </div>

    <!-- Zweite Zeile: Sortierung -->
    <div>
      <label for="sortBy" class="block text-sm font-medium text-gray-700 mb-2">
        Sortierung
      </label>
      <select
        id="sortBy"
        [(ngModel)]="sortBy"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      >
        <option value="date-desc">Datum (Neueste zuerst)</option>
        <option value="date-asc">Datum (Älteste zuerst)</option>
        <option value="name-asc">Name (A-Z)</option>
        <option value="name-desc">Name (Z-A)</option>
      </select>
    </div>
  </div>

  <!-- Auswahl-Aktionen -->
  <div class="px-6 py-3 bg-gray-50 border-b border-gray-200">
    <div class="flex items-center justify-between">
      <div class="text-sm text-gray-700">
        <span class="font-semibold">{{ selectedCount() }}</span> von
        <span class="font-semibold">{{ filteredSets().length }}</span> Sets ausgewählt
      </div>
      <div class="flex gap-2">
        @if (allFilteredSelected()) {
          <button
            (click)="deselectAll()"
            class="px-3 py-1 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors"
          >
            Sichtbare abwählen
          </button>
        } @else {
          <button
            (click)="selectAll()"
            class="px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors"
          >
            Sichtbare auswählen
          </button>
        }
        @if (selectedCount() > 0) {
          <button
            (click)="clearSelection()"
            class="px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors"
          >
            Auswahl aufheben
          </button>
        }
      </div>
    </div>
  </div>

  <!-- Sets-Liste -->
  <div class="flex-1 overflow-y-auto px-6 py-4">
    @if (isLoading()) {
      <div class="flex items-center justify-center py-12">
        <div class="text-gray-500">Lädt Sets...</div>
      </div>
    } @else if (filteredSets().length === 0) {
      <div class="flex items-center justify-center py-12">
        <div class="text-gray-500">Keine Sets gefunden</div>
      </div>
    } @else {
      <div class="space-y-1">
        @for (set of filteredSets(); track set.code) {
          <div
            class="set-row flex items-center gap-4 p-3 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer"
            (click)="toggleSelection(set.code)"
          >
            <!-- Checkbox -->
            <input
              type="checkbox"
              [checked]="isSelected(set.code)"
              (click)="$event.stopPropagation()"
              (change)="toggleSelection(set.code)"
              class="w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
            />

            <!-- Set Icon -->
            <div class="flex-shrink-0">
              @if (set.icon_svg_uri) {
                <img
                  [src]="set.icon_svg_uri"
                  [alt]="set.name + ' Logo'"
                  class="w-8 h-8 object-contain"
                />
              } @else {
                <div class="w-8 h-8 bg-gray-200 rounded"></div>
              }
            </div>

            <!-- Set Info -->
            <div class="flex-1 min-w-0 grid grid-cols-1 md:grid-cols-4 gap-2">
              <!-- Name -->
              <div class="md:col-span-2">
                <div class="font-semibold text-gray-900 truncate">{{ set.name }}</div>
              </div>

              <!-- Code -->
              <div>
                <div class="text-sm text-gray-600">
                  <span class="font-medium">{{ set.code }}</span>
                </div>
              </div>

              <!-- Datum und Typ -->
              <div class="text-sm text-gray-600">
                <div>{{ formatDate(set.released_at) }}</div>
                <div class="text-xs text-gray-500">{{ translateSetType(set.set_type) }}</div>
              </div>
            </div>
          </div>
        }
      </div>
    }
  </div>

  <!-- Footer mit Aktions-Buttons -->
  <div class="px-6 py-4 border-t border-gray-200 bg-gray-50">
    <div class="flex items-center justify-between">
      <button
        (click)="close()"
        class="px-6 py-2 border border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-100 transition-colors"
      >
        Abbrechen
      </button>
      <button
        (click)="addSelectedSets()"
        [disabled]="selectedCount() === 0"
        class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"
      >
        {{ selectedCount() }} {{ selectedCount() === 1 ? 'Set' : 'Sets' }} hinzufügen
      </button>
    </div>
  </div>
</div>
